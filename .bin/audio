#!/bin/bash

mode=$1

_amixer() {
  amixer --quiet --card 0 "$@"
}

_pactl() {
  pactl "$@" 2>/dev/null
}

card=pci-0000_00_1f.3-platform-skl_hda_dsp_generic.HiFi__hw_sofhdadsp
speakers=pci-0000_00_1f.3-platform-skl_hda_dsp_generic.HiFi__hw_sofhdadsp_3

case $mode in
  speakers)
    _amixer sset Speaker mute
    _amixer sset "Bass Speaker" unmute
    _amixer sset Headphone mute
    _pactl set-default-sink alsa_output.${card}__sink
    ;;
  stereo)
    _pactl set-default-sink alsa_output.${speakers}__sink
    ;;
  combine)
    _pactl load-module module-combine-sink
    _pactl set-default-sink combined
    ;;
  uncombine)
    _pactl unload-module module-combine-sink
    ;;
  *)
    echo "usage: $(basename "$0") [ speakers | combine | uncombine ]";
    exit 1;;
esac
